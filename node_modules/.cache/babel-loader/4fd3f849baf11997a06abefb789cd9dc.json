{"ast":null,"code":"import _objectSpread from\"C:/Users/malek/Desktop/web/react-try/descovery/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/malek/Desktop/web/react-try/descovery/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/malek/Desktop/web/react-try/descovery/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/malek/Desktop/web/react-try/descovery/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState,useContext}from\"react\";import AuthContext from'../context/authContext';import\"./GrowItem.scss\";import{Modal}from\"react-bootstrap\";//import FileBase from \"react-file-base64\";\n//import FileUpload from \"../elements/FileUpload\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function PublierArticle(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),baseImage=_useState2[0],setBaseImage=_useState2[1];var auth=useContext(AuthContext);var uploadImage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,base64;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];_context.next=3;return convertBase64(file);case 3:base64=_context.sent;setBaseImage(base64);case 5:case\"end\":return _context.stop();}}},_callee);}));return function uploadImage(_x){return _ref.apply(this,arguments);};}();var convertBase64=function convertBase64(file){return new Promise(function(resolve,reject){var fileReader=new FileReader();fileReader.readAsDataURL(file);fileReader.onload=function(){resolve(fileReader.result);};fileReader.onerror=function(error){reject(error);};});};var titleInputRef=useRef();var contentInputRef=useRef();//const [fileUpload, setFileUpload] = useState(\"\");\nvar submitHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var entredTitle,entredContent,formData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(auth.isLoggedIn){_context2.next=4;break;}console.log(\"pas connecte\");_context2.next=19;break;case 4:event.preventDefault();console.log(auth.EmployeeId+\"hedha l\\'employé mel submit\");entredTitle=titleInputRef.current.value;entredContent=contentInputRef.current.value;// const entredImage = baseImage;\n_context2.prev=8;formData=new FormData();formData.append(\"title\",entredTitle);formData.append(\"employeeId\",auth.EmployeeId);formData.append(\"content\",entredContent);//  console.log(entredImage + \" hedhy el image mel front\");\n_context2.next=15;return fetch(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"createPost\"),{method:\"POST\",body:formData});case 15:_context2.next=19;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](8);case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[8,17]]);}));return function submitHandler(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Modal,_objectSpread(_objectSpread({},props),{},{size:\"lg\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,show:props.show,onHide:props.onHide,backdrop:\"static\",keyboard:false,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,style:{textAlign:\"center\"},children:/*#__PURE__*/_jsx(Modal.Title,{id:\"contained-modal-title-vcenter\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex my-2 justify-content-center text-success\",children:/*#__PURE__*/_jsx(\"h4\",{children:\"Publier un Article\"})})})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,enctype:\"multipart/form-data\",children:[/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"htmlForm-floating \",children:/*#__PURE__*/_jsx(\"label\",{htmlFor:\"title\",children:\"Titre\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"htmlForm-floating \",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"title\",required:true,className:\"form-control\",style:{height:\"30px\"},ref:titleInputRef})}),/*#__PURE__*/_jsx(\"div\",{children:\"Upload an image/video/audio/pdf (optional) !\"}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group mb-3\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:function onChange(e){uploadImage(e);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:baseImage,height:\"200px\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"htmlForm-floating mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"content\",children:\"Content\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"content\",ref:contentInputRef,required:true,className:\"form-control\"})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center \",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary grow mx-2\",onClick:props.onHide,children:\"Annuler\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center \",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success grow mx-2\",type:\"submit\",onClick:props.onHide,children:\"Publier\"})})]})]})]}))});}export default PublierArticle;","map":{"version":3,"sources":["C:/Users/malek/Desktop/web/react-try/descovery/src/components/PublierArticle.js"],"names":["React","useRef","useState","useContext","AuthContext","Modal","PublierArticle","props","baseImage","setBaseImage","auth","uploadImage","e","file","target","files","convertBase64","base64","Promise","resolve","reject","fileReader","FileReader","readAsDataURL","onload","result","onerror","error","titleInputRef","contentInputRef","submitHandler","event","isLoggedIn","console","log","preventDefault","EmployeeId","entredTitle","current","value","entredContent","formData","FormData","append","fetch","process","env","REACT_APP_BACKEND_URL","method","body","show","onHide","textAlign","height"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useContext } from \"react\";\r\nimport  AuthContext  from '../context/authContext';\r\nimport \"./GrowItem.scss\";\r\nimport { Modal } from \"react-bootstrap\";\r\n//import FileBase from \"react-file-base64\";\r\n//import FileUpload from \"../elements/FileUpload\";\r\nfunction PublierArticle(props) {\r\n  const [baseImage, setBaseImage] = useState(\"\");\r\n  const auth = useContext(AuthContext);\r\n  const uploadImage = async (e) => {\r\n    const file = e.target.files[0];\r\n    const base64 = await convertBase64(file);\r\n    setBaseImage(base64);\r\n  };\r\n\r\n  const convertBase64 = (file) => {\r\n    return new Promise((resolve, reject) => {\r\n      const fileReader = new FileReader();\r\n      fileReader.readAsDataURL(file);\r\n\r\n      fileReader.onload = () => {\r\n        resolve(fileReader.result);\r\n      };\r\n\r\n      fileReader.onerror = (error) => {\r\n        reject(error);\r\n      };\r\n    });\r\n  };\r\n  const titleInputRef = useRef();\r\n  const contentInputRef = useRef();\r\n  //const [fileUpload, setFileUpload] = useState(\"\");\r\n\r\n  const submitHandler = async (event) => {\r\n    if(!auth.isLoggedIn){\r\n      console.log(\"pas connecte\");\r\n    }else{event.preventDefault();\r\n      console.log(auth.EmployeeId + \"hedha l\\'employé mel submit\");\r\n      const entredTitle = titleInputRef.current.value;\r\n      const entredContent = contentInputRef.current.value;\r\n     // const entredImage = baseImage;\r\n  \r\n      try {\r\n        const formData = new FormData();\r\n        formData.append(\"title\", entredTitle);\r\n        formData.append(\"employeeId\", auth.EmployeeId);\r\n        formData.append(\"content\", entredContent);\r\n      //  console.log(entredImage + \" hedhy el image mel front\");\r\n        await fetch(`${process.env.REACT_APP_BACKEND_URL}createPost`, {\r\n          method: \"POST\",\r\n          body: formData,\r\n        });\r\n      } catch (err) {}}\r\n  };\r\n\r\n  \r\n  return (\r\n    <>\r\n      <Modal\r\n        {...props}\r\n        size=\"lg\"\r\n        aria-labelledby=\"contained-modal-title-vcenter\"\r\n        centered\r\n        show={props.show}\r\n        onHide={props.onHide}\r\n        backdrop=\"static\"\r\n        keyboard={false}\r\n      >\r\n        <Modal.Header closeButton style={{ textAlign: \"center\" }}>\r\n          <Modal.Title id=\"contained-modal-title-vcenter\">\r\n            <div className=\"d-flex my-2 justify-content-center text-success\">\r\n              <h4>Publier un Article</h4>\r\n            </div>\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n        <form onSubmit={submitHandler} enctype=\"multipart/form-data\" >\r\n          <Modal.Body>\r\n            <div className=\"htmlForm-floating \">\r\n              <label htmlFor=\"title\">Titre</label>\r\n            </div>\r\n            <div className=\"htmlForm-floating \">\r\n              <input\r\n                type=\"text\"\r\n                id=\"title\"\r\n                required\r\n                className=\"form-control\"\r\n                style={{ height: \"30px\" }}\r\n                ref={titleInputRef}\r\n              />\r\n            </div>\r\n\r\n            <div>Upload an image/video/audio/pdf (optional) !</div>\r\n            <div className=\"input-group mb-3\">\r\n              <div>\r\n                <div>\r\n                  <input\r\n                    type=\"file\"\r\n                    onChange={(e) => {\r\n                      uploadImage(e);\r\n                    }}\r\n                  />\r\n                  <br></br>\r\n                  <img alt=\"\" src={baseImage} height=\"200px\" />\r\n                </div>\r\n\r\n                {/*<FileBase\r\n                  type=\"file\"\r\n                  multiple={false}\r\n                  onCh\r\n                  onDone={\r\n                      ({ base64 }) => setFileUpload({ base64 })}\r\n                />*/}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"htmlForm-floating mb-3\">\r\n              <label htmlFor=\"content\">Content</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"content\"\r\n                ref={contentInputRef}\r\n                required\r\n                className=\"form-control\"\r\n              />\r\n            </div>\r\n          </Modal.Body>\r\n          <Modal.Footer>\r\n            <div className=\"d-flex justify-content-center \">\r\n              <button\r\n                className=\"btn btn-secondary grow mx-2\"\r\n                onClick={props.onHide}\r\n              >\r\n                Annuler\r\n              </button>\r\n            </div>\r\n            <div className=\"d-flex justify-content-center \">\r\n              <button\r\n                className=\"btn btn-success grow mx-2\"\r\n                type=\"submit\"\r\n                onClick={props.onHide}\r\n              >\r\n                Publier\r\n              </button>\r\n            </div>\r\n          </Modal.Footer>\r\n        </form>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default PublierArticle;\r\n"]},"metadata":{},"sourceType":"module"}